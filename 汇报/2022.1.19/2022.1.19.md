## python透视消除问题已经解决

原因：之前的程序没有调用了错误的函数，即调用了仿射变换（getAffineTransform、warpAffine）的函数，故只有三组变量，而正确的做法应该调用透视变换的函数（getPerspectiveTransform、warpPerspective），是用四个点作为变量求解变换矩阵，我已经修改了原来的部分代码，文件名undistort_perspective.py，功能为undistort去除畸变和透视变换。

结果展示：

before：

<img src="D:\Courses\IPP\汇报\2022.1.19\f.jpg" alt="f" style="zoom: 13%;" />

after：

<img src="D:\Courses\IPP\汇报\2022.1.19\calibrate_test.jpg" alt="calibrate_test" style="zoom:13%;" />

#### 初步总结：

1. 过程实现脚本自动化，优于matlab
2. 照片像素清晰，优于matlab
3. 可以通过调参数，即函数中的默认参数ratio：

```python
def obthomography_1(dst, criteria, size=4000, ratio=0.03):
```

ratio含义：ratio：相当于棋盘格上一格占图片宽度的比例

通过修改参数0.05->0.03，画面可以放大，因为比例缩小，可以得到更多甚至全部原来的像素信息，但缺点是需要确定到底设置多大比较合理，也许可以规定大概的比例，通过实验得到一个比较合适的参数大小。

### 进行长度测试的检验（同上次matlab，近距离）

before：

<img src="D:\Courses\IPP\serverV2\chessboard_1_8\b.jpg" alt="b" style="zoom:13%;" />

after：

<img src="D:\Courses\IPP\汇报\2022.1.19\c_1.jpg" alt="c_1" style="zoom:15%;" />

利用python去测量尺子长度结果（实际200mm）：

197.89807085897564 mm

误差率：1.05%



before:

<img src="D:\Courses\IPP\汇报\2022.1.19\k.jpg" alt="k" style="zoom:13%;" />

after:

<img src="D:\Courses\IPP\汇报\2022.1.19\c_2.jpg" alt="c_2" style="zoom:15%;" />



利用python去测量尺子长度结果（实际180mm）：

176.04807338780017 mm

误差率：2.20%

##### 一些问题：

1. 似乎一些像素的丢失是不可避免的，我目前初步不能找到解决这个问题。
2. 照片边缘仍然出现了一些畸变，尽管里棋盘格左下角很近。



before:

<img src="D:\Courses\IPP\汇报\2022.1.19\g.jpg" alt="g" style="zoom:15%;" />

after：

<img src="D:\Courses\IPP\汇报\2022.1.19\c_3.jpg" alt="c_3" style="zoom:15%;" />

利用python去测量尺子长度结果（实际200mm）：

195.28952864913163 mm

误差率：2.36%



####  初步总结：

1. python的结果初步来看，误差率在2%左右，略优于matlab
2. 运行速度慢，就上述步骤运行时间大概要2.5min, 尝试修改criteria等一些参数来加快速度，但是效果有限
3. 并没有能够解决部分像素消失的问题，在解决这个问题之前，个人觉得将很难测试远距离的情况

#### 下一步：

1. 找到解决像素丢失的问题, 以及运行速度慢的问题
2. 解决之后（或者想办法在像素丢失的情况下）能够进一步测试python opencv在远距离的精确度
